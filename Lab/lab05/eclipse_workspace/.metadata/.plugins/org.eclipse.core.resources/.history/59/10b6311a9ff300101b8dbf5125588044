/*
 * gps.c
 *
 *  Created on: Oct 3, 2011
 *      Author: nash.reilly
 */

#include <stdio.h>
#include <string.h>
#include "lcdwrite.h"
#include "gpsparse.h"

#define Switches (volatile int *) 0x01001030
#define LEDs 	 (int *) 		  0x01001020

int main()
{
	char test;
	char cs;
	char pkt[83];
	char error[] = "GPS not available.";
	struct packet packet_GGA;
	int temp;

	while(1){
		test=getchar();																/*Gets first character from serial stream             */

		*LEDs = *Switches;
		temp = *LEDs;

		if(checksum(test,cs,pkt)){													/*Pipes all the fun stuff to checksum and parse f'ns  */
			parse_GGA(pkt, &packet_GGA);												/*See gpsparse.h library for full view of functions   */
			//WriteLCD(packet_GGA.latitude);
			WriteLCD(packet_GGA.time);
		} else {
			printf("%s\n", error);
			WriteLCD(error);
		}

	};
	return 0;
}




