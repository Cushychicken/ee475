/*
 * gps.c
 *
 *  Created on: Oct 3, 2011
 *      Author: nash.reilly
 */

#include <stdio.h>
#include <string.h>
#include "lcdwrite.h"
#include "gpsparse.h"

#define Switches (volatile int *) 0x01001030
#define LEDs 	 (int *) 		  0x01001020

int main()
{
	char test;
	char cs;
	char pkt[83];
	struct packet packet_GGA;
	char error1[] = {'G','P','S',' ','n','o','t',' ','r','e','a','d','y','.','\0'};
	char error2[] = {'D','a','t','a',' ','i','s',' ','i','n','v','a','l','i','d','.','\0'};

	while(1){
		test=getchar();																/*Gets first character from serial stream             */

		*LEDs = *Switches;

		if(checksum(test,cs,pkt)){													/*Pipes all the fun stuff to checksum and parse f'ns  */
			parse_GGA(pkt, &packet_GGA);												/*See gpsparse.h library for full view of functions   */
			//WriteLCD(packet_GGA.latitude);
			WriteLCD(packet_GGA.time);
		};

	};
	return 0;
}




